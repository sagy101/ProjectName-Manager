[
  {
    "id": "testAnalyticsLogCommand",
    "command": {
      "base": "echo 'Floating terminal for Test Analytics Logs'",
      "tabTitle": "Test Analytics Logs"
    }
  },
  {
    "id": "mlEngineLogCommand",
    "command": {
      "base": "echo 'ML Engine logs'",
      "tabTitle": "ML Logs"
    }
  },
  {
    "id": "service-a",
    "conditions": {
      "enabled": true,
      "attachState.service-a": false
    },
    "command": {
      "base": "nvm use ${nodeVersion} && cd ./weblifemirror && ./gradlew bootRun --info  -x runDockerComposeAuthService -x buildAgent -x runDockerComposeRuleEngine  -x frontendDev -x runDockerComposeStats -Dspring.profiles.active=localDb,dev,worker,quartz",
      "associatedContainers": [
        "wiremock",
        "weblifemirror-db-replica-1",
        "weblifemirror-db-master-1",
        "weblifemirror-redis-1",
        "weblifemirror-localdb-1"
      ],
      "tabTitle": {
        "base": "Service A"
      }
    }
  },
  {
    "id": "service-a",
    "conditions": {
      "enabled": true,
      "attachState.service-a": true,
      "mode": "suspend"
    },
    "command": {
      "base": "nvm use ${nodeVersion} && cd ./weblifemirror && ./gradlew bootRun --debug-jvm --info  -x runDockerComposeAuthService -x buildAgent -x runDockerComposeRuleEngine  -x frontendDev -x runDockerComposeStats -Dspring.profiles.active=localDb,dev,worker,quartz",
      "associatedContainers": [
        "wiremock",
        "weblifemirror-db-replica-1",
        "weblifemirror-db-master-1",
        "weblifemirror-redis-1",
        "weblifemirror-localdb-1"
      ],
      "tabTitle": {
        "base": "Service A (Debug Suspend)"
      }
    }
  },
  {
    "id": "service-a",
    "conditions": {
      "enabled": true,
      "attachState.service-a": true,
      "mode": "run"
    },
    "command": {
      "base": "nvm use ${nodeVersion} && cd ./weblifemirror && ./gradlew bootRun -Dspring-boot.run.jvmArguments='-agentlib:jdwp=transport=dt_socket,server=y,suspend=n,address=${debugPort}' --info -x runDockerComposeAuthService -x buildAgent -x runDockerComposeRuleEngine -x frontendDev -x runDockerComposeStats -Dspring.profiles.active=localDb,dev,worker,quartz",
      "associatedContainers": [
        "wiremock",
        "weblifemirror-db-replica-1",
        "weblifemirror-db-master-1",
        "weblifemirror-redis-1",
        "weblifemirror-localdb-1"
      ],
      "tabTitle": {
        "base": "Service A (Debug Run)"
      }
    }
  },
  {
    "id": "frontend",
    "conditions": {
      "service-aConfig.enabled": true,
      "frontendConfig.enabled": true,
      "frontendConfig.mode": "dev"
    },
    "command": {
      "base": "cd ./weblifemirror && npx webpack --watch",
      "prefix": "nvm use ${nodeVersion} && ",
      "tabTitle": "Frontend (Dev Mode)"
    }
  },
  {
    "id": "frontend",
    "conditions": {
      "service-aConfig.enabled": true,
      "frontendConfig.enabled": true,
      "frontendConfig.mode": "normal"
    },
    "command": {
      "base": "cd ./weblifemirror && npx webpack --bail",
      "prefix": "nvm use ${nodeVersion} && ",
      "tabTitle": "Frontend"
    }
  },
  {
    "id": "service-b",
    "conditions": {
      "enabled": true,
      "deploymentType": "process"
    },
    "command": {
      "base": "cd ./gopm && make run-local",
      "prefix": "nvm use ${nodeVersion} && ",
      "tabTitle": "Service B (Process)",
      "refreshConfig": {
        "prependCommands": [
          {
            "command": "cd ./weblifemirror/agent/src && make darwin-dev && mv bin/agent-darwin-amd64-dev ../bin && cd ../../.. && "
          }
        ]
      }
    }
  },
  {
    "id": "service-b",
    "conditions": {
      "enabled": true,
      "deploymentType": "container"
    },
    "command": {
      "base": "cd ./gopm && make run-local-docker",
      "associatedContainers": ["serverbrowseragent"],
      "prefix": "nvm use ${nodeVersion} && ",
      "tabTitle": "Service B (Container)"
    }
  },
  {
    "id": "url-intelligence-sub",
    "conditions": {
      "enabled": true,
      "service-cConfig.enabled": true,
      "service-cConfig.mode": "mock"
    },
    "command": {
      "base": "cd ./ThreatIntelligenceMock && node inteligence.js",
      "prefix": "nvm use ${nodeVersion} && ",
      "tabTitle": {
        "base": "URL Intelligence (Mock)"
      }
    }
  },
  {
    "id": "service-c-sub",
    "conditions": {
      "enabled": true,
      "service-cConfig.enabled": true,
      "service-cConfig.mode": "process"
    },
    "command": {
      "base": "cd ./threatintelligence/url-intelligence && kubectx ${kubectlContext} && PROOFPOINT_AUTH_CLIENT_SECRET=$(../../infrastructure/scripts/decode-secret.sh default env-url-intelligence client_secret) PROOFPOINT_AUTH_CLIENT_ID=$(../../infrastructure/scripts/decode-secret.sh default env-url-intelligence client_id) PROOFPOINT_SCORER_CUSTOMER_ID=$(../../infrastructure/scripts/decode-secret.sh default env-url-intelligence customer_id) ./gradlew bootRun --args='--spring.profiles.active=staging --proofpoint.proxy.url= --server.port=8083 --threatintelligence.url=http://127.0.0.1:8084'",
      "prefix": "nvm use ${nodeVersion} && ",
      "tabTitle": {
        "base": "URL Intelligence (Process)"
      }
    }
  },
  {
    "id": "service-c-sub",
    "conditions": {
      "enabled": true,
      "service-cConfig.enabled": true,
      "service-cConfig.mode": "forwarding",
      "urlIntelPodSelected": true
    },
    "command": {
      "base": "cd ./threatintelligence && kubectx ${kubectlContext} && kubectl port-forward ${urlIntelPod} 8083:8080",
      "prefix": "nvm use ${nodeVersion} && ",
      "tabTitle": {
        "base": "URL Intelligence",
        "conditionalAppends": [
          {
            "condition": "service-cConfig.mode === 'forwarding' && urlIntelPodSelected === true",
            "append": " (Forwarding ${urlIntelPod})"
          }
        ]
      }
    }
  },
  {
    "id": "threat-intelligence-sub",
          "conditions": {
        "enabled": true,
        "service-cConfig.enabled": true,
        "threatIntelPodSelected": true
      },
    "command": {
      "base": "kubectx ${kubectlContext} && kubectl port-forward ${threatIntelPod} 8084:8080",
      "prefix": "nvm use ${nodeVersion} && ",
      "tabTitle": {
        "base": "Threat Intelligence"
      }
    }
  },
  {
    "id": "service-d",
    "conditions": {
      "enabled": true,
      "attachState.service-d": false
    },
    "command": {
      "base": "nvm use ${nodeVersion} && cd ./activity-logger && ./gradlew bootRun -Dspring.profiles.active=dev -Dgcloud.project=${gcloudProject}",
      "tabTitle": "Service D"
    }
  },
  {
    "id": "service-d",
    "conditions": {
      "enabled": true,
      "attachState.service-d": true,
      "mode": "suspend"
    },
    "command": {
      "base": "nvm use ${nodeVersion} && cd ./activity-logger && ./gradlew bootRun --debug-jvm -Dspring.profiles.active=dev -Dgcloud.project=${gcloudProject}",
      "tabTitle": "Service D (Debug Suspend)"
    }
  },
  {
    "id": "service-d",
    "conditions": {
      "enabled": true,
      "attachState.service-d": true,
      "mode": "run"
    },
    "command": {
      "base": "nvm use ${nodeVersion} && cd ./activity-logger && ./gradlew bootRun -Dspring-boot.run.jvmArguments='-agentlib:jdwp=transport=dt_socket,server=y,suspend=n,address=${debugPort}' -Dspring.profiles.active=dev -Dgcloud.project=${gcloudProject}",
      "tabTitle": "Service D (Debug Run)"
    }
  },
  {
    "id": "service-e",
    "conditions": {
      "enabled": true,
      "deploymentType": "process"
    },
    "command": {
      "base": "cd rule-engine && ./out/rule-engine",
      "tabTitle": {
        "base": "Service E (Process)"
      },
      "refreshConfig": {
        "prependCommands": [
          {
            "command": "make run-local && "
          }
        ]
      }
    }
  },
  {
    "id": "service-e",
    "conditions": {
      "enabled": true,
      "deploymentType": "container"
    },
    "command": {
      "base": "cd ./weblifemirror && ./gradlew runDockerComposeRuleEngine",
      "associatedContainers": ["rule-engine"],
      "prefix": "nvm use ${nodeVersion} && ",
      "tabTitle": "Service E (Container)"
    }
  },
  {
    "id": "service-f",
    "conditions": {
      "enabled": true,
      "mode": "development"
    },
    "command": {
      "base": "cd test-analytics && npm run dev -- --analytics-mode",
      "tabTitle": {
        "base": "Service F (Dev)"
      }
    }
  },
  {
    "id": "service-f",
    "conditions": {
      "enabled": true,
      "mode": "staging"
    },
    "command": {
      "base": "cd test-analytics && npm run staging -- --analytics-mode",
      "tabTitle": {
        "base": "Service F (Staging)"
      }
    }
  },
  {
    "id": "service-f",
    "conditions": {
      "enabled": true,
      "mode": "production"
    },
    "command": {
      "base": "cd test-analytics && npm run prod -- --analytics-mode",
      "tabTitle": {
        "base": "Service F (Prod)"
      }
    }
  },
  {
    "id": "service-f",
    "conditions": {
      "enabled": true,
      "dataProcessorConfig.enabled": true,
      "dataProcessorConfig.mode": "batch"
    },
    "command": {
      "base": "cd test-analytics/data-processor && python batch_processor.py --mode=${mode}",
      "tabTitle": {
        "base": "Data Processor (Batch)"
      }
    }
  },
  {
    "id": "service-f",
    "conditions": {
      "enabled": true,
      "dataProcessorConfig.enabled": true,
      "dataProcessorConfig.mode": "stream"
    },
    "command": {
      "base": "cd test-analytics/data-processor && python stream_processor.py --mode=${mode}",
      "tabTitle": {
        "base": "Data Processor (Stream)"
      }
    }
  },
  {
    "id": "service-f",
    "conditions": {
      "enabled": true,
      "dataProcessorConfig.enabled": true,
      "dataProcessorConfig.mode": "hybrid"
    },
    "command": {
      "base": "cd test-analytics/data-processor && python hybrid_processor.py --mode=${mode}",
      "tabTitle": {
        "base": "Data Processor (Hybrid)"
      }
    }
  },
  {
    "id": "service-f",
    "conditions": {
      "enabled": true,
      "mlEngineConfig.enabled": true,
      "mlEngineConfig.mode": "tensorflow"
    },
    "command": {
      "base": "cd test-analytics/ml-engine && python run_tf_model.py --env=${mode}",
      "tabTitle": {
        "base": "ML Engine (TensorFlow)"
      }
    }
  },
  {
    "id": "service-f",
    "conditions": {
      "enabled": true,
      "mlEngineConfig.enabled": true,
      "mlEngineConfig.mode": "pytorch"
    },
    "command": {
      "base": "cd test-analytics/ml-engine && python run_pytorch_model.py --env=${mode}",
      "tabTitle": {
        "base": "ML Engine (PyTorch)"
      }
    }
  },
  {
    "id": "service-f",
    "conditions": {
      "enabled": true,
      "mlEngineConfig.enabled": true,
      "mlEngineConfig.mode": "sklearn"
    },
    "command": {
      "base": "cd test-analytics/ml-engine && python run_sklearn_model.py --env=${mode}",
      "tabTitle": {
        "base": "ML Engine (Scikit-learn)"
      }
    }
  },
  {
    "id": "runStorybook",
    "command": {
      "base": "cd ./weblifemirror && nvm use ${nodeVersion} && npm run storybook",
      "tabTitle": "Storybook"
    }
  }
] 
